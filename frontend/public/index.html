<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Tablero de Control - Sistema de GestiÃ³n"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Tablero de Control</title>
    
    <!-- Script de control de versiones y cache busting -->
    <script>
      // VersiÃ³n de la aplicaciÃ³n para cache busting
      window.APP_VERSION = '2.0.0-' + Date.now();
      
      // Detectar si viene de limpieza nuclear
      const urlParams = new URLSearchParams(window.location.search);
      const isNuclear = urlParams.get('nuclear') === 'true';
      const isDirect = urlParams.get('direct') === 'true';
      
      if (isNuclear || isDirect) {
        console.log('ðŸš¨ DETECTADA LIMPIEZA NUCLEAR - Forzando URLs correctas');
        
        // Limpiar cualquier cache residual
        if ('caches' in window) {
          caches.keys().then(names => {
            names.forEach(name => caches.delete(name));
          });
        }
        
        // Forzar recarga de recursos
        window.location.search = '?v=' + Date.now() + '&nuclear=true';
      }
      
      // Interceptar todas las llamadas fetch para reemplazar localhost
      const originalFetch = window.fetch;
      window.fetch = function(url, options) {
        let modifiedUrl = url;
        
        // Si es una URL localhost, reemplazarla con la URL de producciÃ³n
        if (typeof url === 'string' && url.includes('localhost:5001')) {
          modifiedUrl = url.replace('http://localhost:5001', 'https://tablero-control-1.onrender.com');
          console.log('ðŸ”„ Interceptando fetch:', url, 'â†’', modifiedUrl);
        }
        
        return originalFetch(modifiedUrl, options);
      };
      
      // Interceptar XMLHttpRequest tambiÃ©n
      const originalXHROpen = XMLHttpRequest.prototype.open;
      XMLHttpRequest.prototype.open = function(method, url, ...args) {
        let modifiedUrl = url;
        
        if (typeof url === 'string' && url.includes('localhost:5001')) {
          modifiedUrl = url.replace('http://localhost:5001', 'https://tablero-control-1.onrender.com');
          console.log('ðŸ”„ Interceptando XHR:', url, 'â†’', modifiedUrl);
        }
        
        return originalXHROpen.call(this, method, modifiedUrl, ...args);
      };
    </script>
  </head>
  <body>
    <noscript>Necesitas habilitar JavaScript para ejecutar esta aplicaciÃ³n.</noscript>
    <div id="root"></div>
  </body>
</html>
